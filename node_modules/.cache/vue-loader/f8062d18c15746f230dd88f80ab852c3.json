{"remainingRequest":"/Users/zhuyuqing/Desktop/mall/vue-shop-master-2/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhuyuqing/Desktop/mall/vue-shop-master-2/src/views/category/Category.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhuyuqing/Desktop/mall/vue-shop-master-2/src/views/category/Category.vue","mtime":1585591998000},{"path":"/Users/zhuyuqing/Desktop/mall/vue-shop-master-2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuyuqing/Desktop/mall/vue-shop-master-2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhuyuqing/Desktop/mall/vue-shop-master-2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhuyuqing/Desktop/mall/vue-shop-master-2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTbGlkZUJhciBmcm9tICIuL2NoaWxkcmVuL1NsaWRlQmFyIjsKaW1wb3J0IE5hdkJhciBmcm9tICJAL2NvbXBvbmVudHMvY29tbW9uL25hdmJhci9OYXZCYXIiOwppbXBvcnQgeyBnZXRDYXRlZ29yeSwgZ2V0Q2F0ZWdvcnlEZXRhaWwsIGdldFN1YmNhdGVnb3J5IH0gZnJvbSAiQC9uZXR3b3JrL2NhdGVnb3J5IjsKaW1wb3J0IFN1YmNhdGVnb3J5IGZyb20gIi4vY2hpbGRyZW4vU3ViY2F0ZWdvcnkiOwppbXBvcnQgU2Nyb2xsIGZyb20gIkAvY29tcG9uZW50cy9jb21tb24vc2Nyb2xsL1Njcm9sbCI7CmltcG9ydCBUYWJDb250cm9sIGZyb20gIkAvY29tcG9uZW50cy9jb250ZW50L3RhYkNvbnRyb2wvVGFiQ29udHJvbCI7CmltcG9ydCBHb29kc0xpc3QgZnJvbSAiQC9jb21wb25lbnRzL2NvbnRlbnQvZ29vZHMvR29vZHNMaXN0IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQ2F0ZWdvcnkiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICAvLyDliIbnsbvlhoXlrrnmlbDmja4KICAgICAgc3ViY2F0ZWdvcnlMaXN0OiBbXSwKICAgICAgY2F0ZWdvcnlEZXRhaWxMaXN0OiBbXSwKICAgICAgLy8g5YiG57G75L6n6L655qCP5pWw5o2uCiAgICAgIGNhdGVnb3J5TGlzdDogW10sCiAgICAgIHRpdGxlTGlzdDogWyLmtYHooYwiLCAi5paw5qy+IiwgIueyvumAiSJdLAogICAgICBjdXJyZW50SW5kZXg6IDAsCiAgICAgIC8vIOWtmOWCqGtleQogICAgICBrZXlMaXN0OiBbXQogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsgR29vZHNMaXN0LCBUYWJDb250cm9sLCBTY3JvbGwsIFN1YmNhdGVnb3J5LCBOYXZCYXIsIFNsaWRlQmFyIH0sCiAgbWV0aG9kczogewogICAgc2xpZGVCYXJJdGVtQ2xpY2soeyBtYWl0S2V5LCBpbmRleCB9KSB7CiAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gaW5kZXg7CiAgICAgIC8vIOavj+asoeWIh+aNouWIhuexu+WIneWni+WMlnRhYkNvbnRyb2znmoTkuIvmoIcKICAgICAgdGhpcy4kcmVmcy50YWJDb250cm9sLmN1ckluZGV4ID0gMDsKICAgICAgLy8g6K+35rGC5a+55bqU55qE5o6o6I2Q5YiX6KGoCiAgICAgIHRoaXMuZ2V0Q2F0ZWdvcnlEZXRhaWwodGhpcy5jYXRlZ29yeUxpc3RbdGhpcy5jdXJyZW50SW5kZXhdLm1pbmlXYWxsa2V5LCAicG9wIik7CiAgICAgIC8vIOWmguaenGtleUxpc3TkuK3lrZjlnKhtYWl0S2V56K+B5piO5pWw5o2u5bey57uP6K+35rGC6L+H5LqGCiAgICAgIGlmICh0aGlzLmtleUxpc3QuaW5jbHVkZXMobWFpdEtleSkpIHJldHVybiB0aGlzLiRzdG9yZS5jb21taXQoInNldExvYWRpbmciLCBmYWxzZSk7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0TG9hZGluZyIsIHRydWUpOwogICAgICAvLyDlpoLmnpzkuI3lrZjlnKjor7fmsYLmlbDmja7lubbkuJTlrZjlgqhrZXkKICAgICAgdGhpcy5rZXlMaXN0W2luZGV4XSA9IG1haXRLZXk7CiAgICAgIHRoaXMuZ2V0U3ViY2F0ZWdvcnkodGhpcy5jYXRlZ29yeUxpc3RbdGhpcy5jdXJyZW50SW5kZXhdLm1haXRLZXksIGluZGV4KTsKICAgIH0sCiAgICBnZXRDYXRlZ29yeSgpIHsKICAgICAgZ2V0Q2F0ZWdvcnkoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEuY2F0ZWdvcnkubGlzdCk7CiAgICAgICAgdGhpcy5jYXRlZ29yeUxpc3QgPSByZXMuZGF0YS5jYXRlZ29yeS5saXN0OwogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHRoaXMuZ2V0U3ViY2F0ZWdvcnkodGhpcy5jYXRlZ29yeUxpc3RbMF0ubWFpdEtleSwgMCk7CiAgICAgICAgICB0aGlzLmdldENhdGVnb3J5RGV0YWlsKHRoaXMuY2F0ZWdvcnlMaXN0WzBdLm1pbmlXYWxsa2V5LCAicG9wIik7CiAgICAgICAgICAvLyDliJ3lp4vljJZwdXNo56ys5LiA5Liqa2V56L+b5Y67CiAgICAgICAgICB0aGlzLmtleUxpc3QucHVzaCh0aGlzLmNhdGVnb3J5TGlzdFswXS5tYWl0S2V5KTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0U3ViY2F0ZWdvcnkoa2V5LCBpbmRleCkgewogICAgICBnZXRTdWJjYXRlZ29yeShrZXkpLnRoZW4ocmVzID0+IHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YS5saXN0KTsKICAgICAgICB0aGlzLnN1YmNhdGVnb3J5TGlzdFtpbmRleF0gPSByZXMuZGF0YS5saXN0OwogICAgICB9KTsKICAgIH0sCiAgICBnZXRDYXRlZ29yeURldGFpbChrZXksIHR5cGUpIHsKICAgICAgZ2V0Q2F0ZWdvcnlEZXRhaWwoa2V5LCB0eXBlKS50aGVuKHJlcyA9PiB7CiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzKTsKICAgICAgICB0aGlzLmNhdGVnb3J5RGV0YWlsTGlzdCA9IHJlczsKICAgICAgfSk7CiAgICB9LAogICAgdGFiQ2xpY2soaW5kZXgpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRMb2FkaW5nIiwgdHJ1ZSk7CiAgICAgIGNvbnN0IHR5cGVMaXN0ID0gWyJwb3AiLCAibmV3IiwgInNlbGwiXTsKICAgICAgLy8g5YiH5o2i57G75Z6L5pWw5o2uCiAgICAgIHRoaXMuZ2V0Q2F0ZWdvcnlEZXRhaWwodGhpcy5jYXRlZ29yeUxpc3RbdGhpcy5jdXJyZW50SW5kZXhdLm1pbmlXYWxsa2V5LCB0eXBlTGlzdFtpbmRleF0pOwogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0Q2F0ZWdvcnkoKTsKICB9LAogIGRlYWN0aXZhdGVkKCkgewogICAgLy8g5q+P5qyh56a75byA5oGi5aSNbG9hZGluZ+WKoOi9vQogICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRMb2FkaW5nIiwgdHJ1ZSk7CiAgfQp9Owo="},{"version":3,"sources":["Category.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Category.vue","sourceRoot":"src/views/category","sourcesContent":["<template>\n  <div class=\"category\">\n    <nav-bar class=\"category-nav-bar\">\n      <div slot=\"center\">商品分类</div>\n    </nav-bar>\n    <slide-bar :slide-bar-list=\"categoryList\" @slideBarItemClick=\"slideBarItemClick\" />\n    <scroll class=\"scroll-height\">\n      <subcategory :category-list=\"subcategoryList[currentIndex]\" />\n      <tab-control :titles=\"titleList\" @tabClick=\"tabClick\" ref=\"tabControl\" />\n      <goods-list :goods=\"categoryDetailList\" />\n    </scroll>\n  </div>\n</template>\n\n<script>\nimport SlideBar from \"./children/SlideBar\";\nimport NavBar from \"@/components/common/navbar/NavBar\";\nimport { getCategory, getCategoryDetail, getSubcategory } from \"@/network/category\";\nimport Subcategory from \"./children/Subcategory\";\nimport Scroll from \"@/components/common/scroll/Scroll\";\nimport TabControl from \"@/components/content/tabControl/TabControl\";\nimport GoodsList from \"@/components/content/goods/GoodsList\";\n\nexport default {\n  name: \"Category\",\n  data() {\n    return {\n      // 分类内容数据\n      subcategoryList: [],\n      categoryDetailList: [],\n      // 分类侧边栏数据\n      categoryList: [],\n      titleList: [\"流行\", \"新款\", \"精选\"],\n      currentIndex: 0,\n      // 存储key\n      keyList: []\n    };\n  },\n  components: { GoodsList, TabControl, Scroll, Subcategory, NavBar, SlideBar },\n  methods: {\n    slideBarItemClick({ maitKey, index }) {\n      this.currentIndex = index;\n      // 每次切换分类初始化tabControl的下标\n      this.$refs.tabControl.curIndex = 0;\n      // 请求对应的推荐列表\n      this.getCategoryDetail(this.categoryList[this.currentIndex].miniWallkey, \"pop\");\n      // 如果keyList中存在maitKey证明数据已经请求过了\n      if (this.keyList.includes(maitKey)) return this.$store.commit(\"setLoading\", false);\n      this.$store.commit(\"setLoading\", true);\n      // 如果不存在请求数据并且存储key\n      this.keyList[index] = maitKey;\n      this.getSubcategory(this.categoryList[this.currentIndex].maitKey, index);\n    },\n    getCategory() {\n      getCategory().then(res => {\n        // console.log(res.data.category.list);\n        this.categoryList = res.data.category.list;\n        this.$nextTick(() => {\n          this.getSubcategory(this.categoryList[0].maitKey, 0);\n          this.getCategoryDetail(this.categoryList[0].miniWallkey, \"pop\");\n          // 初始化push第一个key进去\n          this.keyList.push(this.categoryList[0].maitKey);\n        });\n      });\n    },\n    getSubcategory(key, index) {\n      getSubcategory(key).then(res => {\n        // console.log(res.data.list);\n        this.subcategoryList[index] = res.data.list;\n      });\n    },\n    getCategoryDetail(key, type) {\n      getCategoryDetail(key, type).then(res => {\n        // console.log(res);\n        this.categoryDetailList = res;\n      });\n    },\n    tabClick(index) {\n      this.$store.commit(\"setLoading\", true);\n      const typeList = [\"pop\", \"new\", \"sell\"];\n      // 切换类型数据\n      this.getCategoryDetail(this.categoryList[this.currentIndex].miniWallkey, typeList[index]);\n    }\n  },\n  created() {\n    this.getCategory();\n  },\n  deactivated() {\n    // 每次离开恢复loading加载\n    this.$store.commit(\"setLoading\", true);\n  }\n};\n</script>\n\n<style scoped>\n.category-nav-bar {\n  font-weight: 600;\n  color: white;\n  background-color: #ff8198;\n}\n\n.scroll-height {\n  position: fixed;\n  top: 44px;\n  right: 0;\n  bottom: 50px;\n  left: 100px;\n  overflow: hidden;\n}\n</style>\n"]}]}